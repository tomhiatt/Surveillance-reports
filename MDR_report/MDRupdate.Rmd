---
title: "Drug resistant tuberculosis in the WHO Western Pacific Region"
author: "Tauhid Islam,<sup>&dagger;</sup> Tom Hiatt,<sup>&dagger;</sup> Cornelia Hennig,<sup>&dagger;</sup> Nobuyuki Nishikiori<sup>&dagger;</sup>"
bibliography: MDRupdate.bib
csl: springer-vancouver.csl
output:
  html_document:
    fig_caption: yes
    keep_md: yes
    number_sections: no
    theme: united
    toc: yes
  word_document:
    fig_height: 7
---


```{r setup, echo=FALSE, include=FALSE}

###################################################
# Tom Hiatt
# Updated: 12 March 2014
# Regional MDR-TB annual analysis
###################################################

## Change this information to customize for your own data.

# Year of TB notification data
yr <- 2013
# 

###################################################

# > sessionInfo()

require("reshape")
require("ggplot2")
require("grid")
require("scales")
require("xtable")
require("stringr")
require("timeSeries")
require("ggthemes")
require("Gmisc")


# Reproducible research process inspired by: http://gforge.se/2014/01/fast-track-publishing-using-knitr-part-ii/ and http://gforge.se/2014/07/fast-track-publishing-using-rmarkdown/

# Citation directions here: http://rmarkdown.rstudio.com/authoring_pandoc_markdown.html#citations and here: http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html

##################
# Knitr settings #
##################
require(knitr) 
knitr::opts_chunk$set(warning=FALSE,
    			  message=FALSE,
					  echo=FALSE,
					  dpi=96,
					  fig.width=4, fig.height=4, # Default figure widths
					  dev="png", dev.args=list(type="cairo"), # The png device
					  # Change to dev="postscript" if you want the EPS-files
					  # for submitting. Also remove the dev.args() as the postscript
					  # doesn't accept the type="cairo" argument.
					  error=FALSE)

# Create regional report folder if needed.
# dir.create("./Regional_report") # run this if error below
# dir.create("./figure data") # run this if error below
if(!any(grep("MDR_report", getwd()))) setwd("./MDR_report")

# Theme for plots
theme_report <- function(base_size=12, base_family="") {
    colors <- ggthemes_data$few
    gray <- colors$medium['gray']
    black <- colors$dark['black'] # I don't know why these last 3 parts are needed, but they are. List is here: http://docs.ggplot2.org/0.9.2.1/theme.html
    theme_bw(base_size=base_size, base_family=base_family) +
        theme(
            line = element_line(colour = gray),
            rect = element_rect(fill = "white", colour = NA),
            text = element_text(colour = black),
            axis.ticks.x = element_line(colour = gray),
            axis.ticks.y = element_blank(),
            legend.key = element_rect(colour = NA),
            ## Examples do not use grid lines
            panel.border = element_rect(colour = gray),
            panel.grid.major.x = element_blank(),
            panel.grid.minor = element_blank(),
            strip.background = element_rect(fill="white", colour=NA),
            strip.text = element_text(hjust=0)
            )
}

########################################################
# Functions for data formatting
########################################################

# Simple rounder that just adds in the thousands separator 
rounder <- function(x, decimals=FALSE) {
  if(decimals==TRUE){
    ifelse(is.na(x), NA, ifelse(x==0, 0, ifelse(x < 0.01, "<0.01", ifelse(round(x,2) < 0.1, formatC(round(x,2), format='f', digits=2), ifelse(round(x,1) < 10, formatC(round(x,1), format='f', digits=1), formatC(round(x,0), big.mark=" ", format='d') )))))
  }
  else ifelse(is.na(x), NA, ifelse(x==0, 0, ifelse(x < 1, "< 1", formatC(round(x,0), big.mark=" ", format='d'))))
}

.rowsums <- function(x) { 
  # This function sums rows ignoring NAs unless all are NA
  # use it like this
  # t3c$snu <- .rowsums(t3c[c('new_sn', 'new_su')])
  	tosum <- as.matrix(x)
		summed <- rowMeans((tosum), na.rm=T) * rowSums(!is.na((tosum)))
		return(summed)
}

# Change names to WPSAR convention
.WPSARnames <- function(d, col='country', ord='no order'){
  d[col] <- as.character(d[[col]])
  d[col] <- ifelse(d[[col]]=='China, Hong Kong SAR', 'Hong Kong Special Administrative Region (China)', 
                   ifelse(d[[col]]=='China, Macao SAR', 'Macao Special Administrative Region (China)', 
                          ifelse(d[[col]]=='Micronesia (Federated States of)', 'Micronesia, Federated States of', 
                                 ifelse(d[[col]]=='WPR', 'Western Pacific Region
', d[[col]]))))

  if(!ord %in% c('wpr')) warning('Not ordering.')
if(ord=='wpr')  d <- d[match(c("Afghanistan", "Bangladesh", "Brazil", "Cambodia", "China", "DR Congo", "Ethiopia", "India", "Indonesia", "Kenya", "Mozambique",  "Myanmar", "Nigeria", "Pakistan", "Philippines", "Russian Federation", "South Africa", "Thailand", "Uganda", "UR Tanzania", "Viet Nam", "Zimbabwe", "High-burden countries", "AFR", "AMR", "EMR", "EUR", "SEAR", "WPR", "Global"), d[[col]]),]

  return(d)
}

########################################################
# Functions for maps
########################################################

source("./MapFunctions.r")
load("gparts.Rdata")

########################################################
# Functions to assist with tables and figure in markdown document (from here: http://rmflight.github.io/posts/2012/10/papersinRmd.html)
########################################################

incCount <- function(inObj, useName) {
  nObj <- length(inObj)
  useNum <- max(inObj) + 1
  inObj <- c(inObj, useNum)
  names(inObj)[nObj + 1] <- useName
  inObj
}
figCount <- c(`_` = 0)
tableCount <- c(`_` = 0)

tableCount

pasteLabel <- function(preText, inObj, objName, insLink = TRUE, sepper = " ") {
  objNum <- inObj[objName]
  
  useText <- paste(preText, objNum, sep = sepper)
  if (insLink) {
    useText <- paste("[", useText, "](#", objName, ")", sep = " ")
  }
  useText
}

tableCat <- function(inFrame) {
  outText <- paste(names(inFrame), collapse = " | ")
  outText <- c(outText, paste(rep("---", ncol(inFrame)), collapse = " | "))
  invisible(apply(inFrame, 1, function(inRow) {
    outText <<- c(outText, paste(inRow, collapse = " | "))
  }))
  return(outText)
}

################################################
# Create directory and Get data 
################################################

external.data <- FALSE

if(!external.data){
  source("D:/Users/hiattt/Dropbox/Code/R/.Rprofile")
  runprofile()
} 

if(external.data){
 if(!"data" %in% dir() | length(dir("./data"))==0){
  dir.create(paste("./data"))
  stop("Download the notification and treatment outcomes data from 'http://who.int/tb/country/data/download/en/' to './data'.")
  }

data1 <- dir("./data", full.names=TRUE)
tb <- NA
for(i in data1){
  data3 <- read.csv(i)
  tb <- merge(tb, data3, all=TRUE)
}

# Note: to use your own data, make a flat data file with each row corresponding to the lower reporting unit and a aggregating variable. EG by country with aggregating variable of region.

# Add needed variables
tb$g_hbc22 <- ifelse(tb$iso3 %in% c("AFG", "BGD", "BRA", "CHN", "COD", "ETH", "IDN", "IND", "KEN", "KHM", "MMR", "MOZ", "NGA", "PAK", "PHL", "RUS", "THA", "TZA", "UGA", "VNM", "ZAF", "ZWE"), "high", "low")

tb$c_new <- .rowsums(tb[c("new_sp", "new_sn", "new_su", "new_ep", "new_oth")])
tb$c_newinc <- .rowsums(tb[c("c_new", "ret_rel", "newret_oth")])
tb$c_ret <- .rowsums(tb[c("ret_rel", "ret_taf", "ret_tad", "ret_oth")])
tb$c_notified <- .rowsums(tb[c("c_new", "c_ret", "newret_oth")])

tb$c_tot_newrel_100k <- tb$tot_newrel / tb$e_pop_num * 1e5

# Get population data (available from UN population division. http://esa.un.org/unpd/wpp/unpp/panel_population.htm) and formatted TB/HIV data and estimates for the WHO Western Pacific Region.

} # End of external data part


# Common data munging 

whbc <- subset(tb, g_whoregion=="WPR" & year==yr & mdr>=1, c(iso3))
whbc <- whbc$iso3
               
#                c("KHM", "CHN", "JPN", "MYS", "MNG", "PNG", "PHL", "KOR", "VNM")

tb$country2 <- ifelse(tb$iso3 %in% whbc, as.character(tb$iso3), "Other") 
tb$country2 <- factor(tb$country2, c("KHM", "CHN", "JPN", "MYS", "MNG", "PNG", "PHL", "KOR", "VNM", "Other"), c("Cambodia", "China", "Japan", "Malaysia", "Mongolia", "Papua New Guinea", "Philippines", "Republic of Korea", "Viet Nam", "Other countries"))


```



<sup>&dagger;</sup> Stop TB and Leprosy Elimination, Division of Communicable Disease, World Health Organization Regional Office for the Western Pacific, Manila, Philippines

Running title: DR-TB in the WHO Western Pacific Region

Key words: tuberculosis; surveillance; drug-resistance; MDR-TB; Western Pacific Region

Corresponding author: 
Tauhid Islam
Stop TB and Leprosy Elimination
Division of Communicable Disease
World Health Organization Regional Office for the Western Pacific
Manila, Philippines 
Tel: +632 5289720
Email: islamt@wpro.who.int


Abstract 
--------------------------------------------------------

Test citation @Angermeyer2004

Blah blah [see @Angermeyer2004, pp. 33-35; also @Kirkwood2003, ch. 1].

Blah blah [@Angermeyer2004, pp. 33-35, 38-39 and *passim*].

Blah blah [@Kirkwood2003; @Angermeyer2004].

Smith says blah [-@Kirkwood2003].

@Kirkwood2003 says blah.

@Kirkwood2003 [p. 33] says blah.


Introduction
--------------------------------------------------------

Even less than 5% of TB burden is MDR-TB, this poses a formidable challenge to the prospect of controlling TB due to the following reasons; (1) as incidence of TB decline the drug resistant strain may dominate the epidemic (2) treatment duration is too long, around 2 years and complicated due to severe side effects of the second line drugs (3) management cost is too high and responsible for the catastrophic expenditure (4) treatment outcome is very poor and (5) it poses a huge burden on existing health system as human resource and technical capacity are not ready to tackle this issue. 

Globally, a total of 450 000 (range 300 000–600 000) people are estimated to have developed multidrug-resistant TB (MDR-TB; resistance to at least rifampicin and isoniazid) in 2012 [Global TB Report 2013]. Among them, aapproximately one quarter MDR-TB occurred in countries of the Western Pacific Region of the World Health Organization (WHO). Most (more than 98%) of the MDR-TB patients are in three countries, namely China, the Philippines and Viet Nam.  

The Region has made substantial progress and reached Millennium Development Goal (MDG) targets in advance of 2015.  TB prevalence and mortality are below half of 1990 levels, and case detection and treatment success remain high (Reference…).  However, the challenges of TB remain monumental.  Annually, an estimated 1.6 million people develop TB, and 110 000 die from this curable illness.  TB concentrates on vulnerable populations, such as migrants, children, elderly and poor people.  Meanwhile, every year the Region's burden increases by an estimated 74 000 MDR-TB cases—only 6.8% of which are treated under quality-assured programmes.  



To address the problem of drug resistance in the WHO Western Pacific Region, Regional strategy to stop tuberculosis in the Western Pacific 2011-2015 identified scaling up the programmatic management of drug resistant TB as one of the five objectives (Reference for the strategy). Surveillance of resistance to anti-TB drugs and monitor the progress of programmatic implementation are fundamental component of the strategy. 

In 2011 the Western Pacific Region Green Light Committee (WPR rGLC) was established to assist member countries with responsible PMDT scale-up. Member countries were at different stages of PMDT implementation with consequent diverse needs. The region included countries with high MDR-TB caseloads such as China, Vietnam and the Philippines and remote Pacific Island nations with very small, irregular caseloads.2 Local expertise varied from the oldest GLC-approved programme, in the Philippines,3 to settings without any PMDT experience. 

This article is the second in series of regional TB situation analysis (reference: WPSAR). In this article, we review the latest available information about drug resistance in the WHO Western Pacific Region and it's programmatic implementation. We provide a brief overview of WPR rGLC activities, reflect on achievements and challenges, and explore its potential future role.



Methods
--------------------------------------------------------

The WHO Western Pacific Region includes 36 countries and areas.  In 2013, 30 countries and areas of the Western Pacific Region reported data representing more than 99.9% of the total population. Since 2009, a web-based online system has been used for data submission and validation. Collected data covers the following areas: TB case notifications and treatment outcomes, diagnostic and treatment services, drug management, surveillance and surveys of drug-resistance, information on TB/HIV co-infection, infection control, engagement of all care providers and budgets and expenditures for TB control. The full description of methods is available in the Global Tuberculosis Report 2013 and the data sets are available from the WHO global TB database (www.who.int/tb/data). 

ALSO MENTION ABOUT SURVEY AND SURVEILLANCE DATA TO CALCULATE RATES AND TRENDS.

Analysis was conducted by the statistical package R (R Core Team, 2013, Vienna, Austria, www.R-project.org). Due to calls for transparent and reproducible research, ^5,6 we have published programme code to generate the entire contents of this article including all figures and tables by using R with the knitr package (Yihui Xie, 2013). Readers can download the code (see supplement material) and reproduce all figures and tables under an appropriate personal computing environment. For non-commercial purposes, readers may modify the code to produce figures and tables that are not presented in this article. For instance, readers may wish to produce tables and figures for countries or regions other than the WHO Western Pacific Region.


```{r Versions}
info <- sessionInfo()
r_ver <- paste(info$R.version$major, info$R.version$minor, sep=".")
```
 
All analyses were performed using R (ver. `r r_ver`)[R Core Team, 2013] and packages rms (ver. `r info$otherPkgs$rms$Version`) [F. Harrell, 2014] for analysis, Gmisc for plot and table output (ver. `r info$otherPkgs$Gmisc$Version`), and knitr (ver `r info$otherPkgs$knitr$Version`) [Xie, 2013] for reproducible research.
 

### Analysis and reproducibility
Analysis was conducted by the statistical package R (R Core Team, 2013, Vienna, Austria, www.R-project.org). Due to calls for transparent and reproducible research,^5,6 we have published programme code to generate the entire contents of this article including all figures and tables by using R with the knitr package (Yihui Xie, 2013). Readers can download the code (see supplement material) and reproduce all figures and tables under an appropriate personal computing environment. For non-commercial purposes, readers may modify the code to produce figures and tables that are not presented in this article. For instance, readers may wish to produce tables and figures for countries or regions other than the WHO Western Pacific Region.


Findings
--------------------------------------------------------

```{r m-coverage-data, warning=FALSE}
figCount <- incCount(figCount, "m-coverage")

coa <- read.table(textConnection("
iso3 coverage year
AUS Nationwide	2013
BRN	Nationwide	2013
KHM	Nationwide	2007
CHN	Nationwide	2014
HKG	Nationwide	2012
MAC	Nationwide	2013
COK	Nationwide	2013
FJI	Nationwide	2006
PYF	Nationwide	2013
GUM	Nationwide	2012
JPN	Nationwide	2002
MYS	Subnational	1997
MHL	Nationwide	2013
MNG	Nationwide	2007
NCL	Nationwide	2012
NZL	Nationwide	2012
MNP	Nationwide	2012
PLW	Nationwide	2013
PNG	Subnational	2014
PHL	Nationwide	2012
KOR	Nationwide	2004
WSM	Nationwide	2013
SGP	Nationwide	2013
SLB	Nationwide	2004
VUT	Nationwide	2006
VNM	Nationwide	2012
"), header = TRUE, as.is = TRUE)
# closeAllConnections() # This breaks stuff if left in there.

coa$cat <- cut(coa$year, c(0, 2005, 2010, 2014, Inf), c('1997–2004', '2005–2009', '2010–2013', 'Ongoing survey in 2014'), right=FALSE)
# 
mc1 <- WHOmap.print(coa, legend.title= "Year of most \nrecent data", copyright=FALSE, show=FALSE, zoom="WPR")

write.csv(coa, file=paste0(pasteLabel("./figure_data/table", tableCount, "m-coverage", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```

### Coverage of drug resistance surveillance 

Drug resistance data were available from X  of the 36 countries and areas of the WHO Western Pacific Region. X countries have continuous surveillance system. X countries rely on special survey of representative samples of patients. Nationwide and population representative data were available from X countries. X countries have data from certain geographical area that are not considered representative of the country a whole. Some surveys are ongoing such as PNG which is expected to produce sub national data by 2015.

<a id="m-coverage"></a> 

##### `r I(pasteLabel("Figure", figCount, "m-coverage", insLink=FALSE))`.	Progress in regional coverage of surveillance data on drug resistance, `r paste0(range(coa$year), collapse="\u2013")`<sup>a</sup>
``` {r m-coverage, fig.width=9, fig.height=9}
mc1
```

<sup>a</sup> Coverage in Malaysia and Papua New Guinea is at the subnational level only.

Of the X countries with surveillance data, X had data from only one single survey or one year of surveillance. X countries had data from more than 2 points. Time trend could be observed from X countries. 

```{r t-est-enroll-data, warning=FALSE}
tableCount <- incCount(tableCount, "t-est-enroll")

# Notification table

oa <- subset(tb, year==yr & g_whoregion=="WPR", 
              select=c(iso3, g_whoregion, country, 
                       e_mdr_num, e_mdr_num_lo, e_mdr_num_hi,
                       mdr, rapid_dx_dr_r, 
                       conf_mdr_tx, unconf_mdr_tx))

oa <- oa[order(oa$country),]
names(oa)[names(oa)=='country'] <- 'area'
estvars <- c("e_mdr_num", "e_mdr_num_lo", "e_mdr_num_hi")

# make aggregate rows
ob <- oa[oa$iso3 %in% whbc, ]
obh <- aggregate(ob[4:ncol(ob)], by=list(area=ob$g_whoregion), FUN=sum, na.rm=TRUE)
obh$area <- "Total"
obh[estvars] <- NA # Not the proper way to sum bounds. Maybe to replace this later.

obw <- aggregate(oa[4:ncol(oa)], by=list(area=oa$g_whoregion), FUN=sum, na.rm=TRUE)
obw[estvars] <- subset(emdra, year==yr & group_name=="WPR", estvars) # Proper sums for aggregates.

# combine together
oc <- rbind(ob[3:ncol(ob)], obh, obw) 

# calculate and format vars

oc$e_mdr_num_range <- paste0("(", rounder(oc$e_mdr_num_lo), "&#8211;", rounder(oc$e_mdr_num_hi), ")")

oc$pmdr <- .rowsums(oc[c('mdr', 'rapid_dx_dr_r')])
oc$mdr_tx <- .rowsums(oc[c('conf_mdr_tx', 'unconf_mdr_tx')])

oc$pmdr_pct <- rounder(oc$pmdr / oc$e_mdr_num * 100)
oc$pmdr_pct_range <- paste0("(", rounder(oc$pmdr / oc$e_mdr_num_hi * 100), "&#8211;", rounder(oc$pmdr / oc$e_mdr_num_lo * 100), ")")

oc$mdr_tx_pct <- rounder(oc$mdr_tx / oc$pmdr * 100)

# Format
oc$e_mdr_num <- rounder(oc$e_mdr_num)

for(var in 2:ncol(oc)){
  oc[var] <- ifelse(is.na(oc[[var]]), "&#8211;", oc[[var]])
}


# Rename countries
od <- .WPSARnames(oc, col="area")

rownames(od) <- od$area

oe <- subset(od, select=c("e_mdr_num", "e_mdr_num_range", "pmdr", "pmdr_pct", "pmdr_pct_range", "mdr_tx", "mdr_tx_pct"))


write.csv(oe, file=paste0(pasteLabel("./figure_data/table", tableCount, "t-est-enroll", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```

<a id="t-est-enroll"></a> 

##### `r I(pasteLabel("Table", tableCount, "t-est-enroll", insLink=FALSE))`. Estimated drug resistant cases compared with notified cases and cases put on treatment, `r yr`
```{r t-est-enroll, results='asis'}
             
# Make that table
htmlTable(oe, caption = "", rowlabel = "", cgroup = rbind(c("MDR-TB cases<sup>*</sup>", "Enrolled on treatment", rep(NA,3)), c("Estimated", "Detected", "%", "Number", "%")), n.cgroup = rbind(c(3,2, rep(NA,3)), c(2,1,2,1,1)), align=c(rep(c('r','l','r'),2), 'r'), ctable = TRUE, tfoot = "<sup>*</sup> All columns except estimates include Rif-resistant cases confirmed by Xpert only.", headings = NA )

```

### MDR-TB rate
The proportion of previously treated TB cases with MDR-TB ranged from 3% to 34%. Country with the highest estimated proportion was Mongolia, 34% (95% CI: 29-38).
The proportion of new TB cases with MDR-TB ranged from 1% to 6%.  China has the highest proportion of MDR-TB among new cases 6% (95% CI: 5-7).
Combining data from all countries of the Region, 4% (95% confidence interval: 3-6) of new and 22% (95% CI: 18-26) of previously treated TB cases were estimated to have MDR-TB.  		
Though highest % is observed among retreatment cases, absolute number of estimated MDR cases is lower among retreatment cases than the new cases. Among the total estimated MDR-TB, 24% are in retreatment cases and 76% are in new cases.

```{r t-drnotif-data, warning=FALSE}
tableCount <- incCount(tableCount, "t-drnotif")

# Notification table

nb <- subset(tb, year==yr & g_whoregion=="WPR", 
              select=c(iso3, g_whoregion, country,
                       new_labconf, new_clindx, 
                       ret_rel_labconf, ret_rel_clindx, ret_nrel, 
                       cullpa_new, cullpa_ret, cullpa_unk, 
                       dst_rlt_new, dst_rlt_ret, dst_rlt_unk, 
                       dr_h_nr_new,  dr_h_nr_ret,  dr_h_nr_unk, 
                       dr_r_nh_new,  dr_r_nh_ret,  dr_r_nh_unk, 
                       mdr_new,  mdr_ret,  mdr_unk,
                       xpert_new, xpert_ret, xpert_unk, 
                       xpert_dr_r_new, xpert_dr_r_ret, xpert_dr_r_unk))

nb <- nb[order(nb$country),]
names(nb)[names(nb)=='country'] <- 'area'

# make aggregate rows
nbc <- nb[nb$iso3 %in% whbc, ]
nbch <- aggregate(nbc[4:ncol(nbc)], by=list(area=nbc$g_whoregion), FUN=sum, na.rm=TRUE)
nbch$area <- "Total"

nbcw <- aggregate(nb[4:ncol(nb)], by=list(area=nb$g_whoregion), FUN=sum, na.rm=TRUE)

# combine together
nbd <- rbind(nbc[3:ncol(nbc)], nbch, nbcw) # , tbbh, tbbga

# calculate and format vars
nbd$pulm_new <- .rowsums(nbd[c('new_labconf', 'new_clindx')])
nbd$pulm_ret <- .rowsums(nbd[c('ret_rel_labconf', 'ret_rel_clindx', 'ret_nrel')])
nbd$pulm_all <- .rowsums(nbd[c('pulm_new', 'pulm_ret')])

nbd$dst_rlt_new_pct <- nbd$dst_rlt_new / nbd$pulm_new * 100
nbd$dst_rlt_ret_pct <- nbd$dst_rlt_ret / nbd$pulm_ret * 100
nbd$dst_rlt <- .rowsums(nbd[c('dst_rlt_new', 'dst_rlt_ret', 'dst_rlt_unk')])
nbd$dst_rlt_pct <- nbd$dst_rlt /  nbd$pulm_all * 100

nbd$dr_h_nr_new_pct <- nbd$dr_h_nr_new / nbd$dst_rlt_new * 100
nbd$dr_h_nr_ret_pct <- nbd$dr_h_nr_ret / nbd$dst_rlt_ret * 100
nbd$dr_h_nr_pct <- .rowsums(nbd[c('dr_h_nr_new', 'dr_h_nr_ret', 'dr_h_nr_unk')]) /  nbd$dst_rlt * 100

nbd$dr_r_nh_new_pct <- nbd$dr_r_nh_new / nbd$dst_rlt_new * 100
nbd$dr_r_nh_ret_pct <- nbd$dr_r_nh_ret / nbd$dst_rlt_ret * 100
nbd$dr_r_nh_pct <- .rowsums(nbd[c('dr_r_nh_new', 'dr_r_nh_ret', 'dr_r_nh_unk')]) /  nbd$dst_rlt * 100

nbd$mdr_new_pct <- nbd$mdr_new / nbd$dst_rlt_new * 100
nbd$mdr_ret_pct <- nbd$mdr_ret / nbd$dst_rlt_ret * 100
nbd$mdr_pct <- .rowsums(nbd[c('mdr_new', 'mdr_ret', 'mdr_unk')]) /  nbd$dst_rlt * 100

nbd$xpert <- .rowsums(nbd[c('xpert_new', 'xpert_ret', 'xpert_unk')])

nbd$xpert_dr_r_new_pct <- nbd$xpert_dr_r_new / nbd$xpert_new * 100
nbd$xpert_dr_r_ret_pct <- nbd$xpert_dr_r_ret / nbd$xpert_ret * 100
nbd$xpert_dr_r_pct <- .rowsums(nbd[c('xpert_dr_r_new', 'xpert_dr_r_ret', 'xpert_dr_r_unk')]) /  nbd$xpert * 100

# Format
for(var in 2:ncol(nbd)){
  nbd[var] <- ifelse(is.na(nbd[[var]]), "&#8211;", rounder(nbd[[var]]))
}


# Rename countries
nbe <- .WPSARnames(nbd, col="area")

# Consider adding a column for put on treatment and/or including those from the other MDR table.

rownames(nbe) <- nbe$area

nbf <- subset(nbe, select=c("dst_rlt_new", "dst_rlt_ret", "dst_rlt", "dst_rlt_new_pct", "dst_rlt_ret_pct", "dst_rlt_pct", "dr_h_nr_new_pct", "dr_h_nr_ret_pct", "dr_h_nr_pct", "dr_r_nh_new_pct", "dr_r_nh_ret_pct", "dr_r_nh_pct", "mdr_new_pct", "mdr_ret_pct", "mdr_pct", "xpert_new", "xpert_ret", "xpert", "xpert_dr_r_new_pct", "xpert_dr_r_ret_pct", "xpert_dr_r_pct"))

names(nbf) <- c("New", "Ret.", "Total", "New", "Ret.", "Total", "New", "Ret.", "Total", "New", "Ret.", "Total", "New", "Ret.", "Total", "New", "Ret.", "Total", "New", "Ret.", "Total")



write.csv(nbf, file=paste0(pasteLabel("./figure_data/table", tableCount, "t-drnotif", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```


### Management of drug resistant TB: 
  	
#### DST coverage
			Table: % of DST result among new and reTx
DST coverage data was reported from 17 countries (47%  of 36 Member Countries and Areas). Only 3% of new bacteriologically confirmed TB cases and 14% of those previously treated for TB were tested for MDR-TB (Rifampicin resistance status). In previously treated cases, the coverage of testing was lowest in Viet Nam (4%). Testing for MDR-TB among new cases, the coverage of testing was less than 1% in Lao PDR, Philippines and Viet Nam. TREND OF DST COVERAGE (2005-2014). The testing coverage among retreatment is increasing steadily over the years.

Among cases with phenotypic DST result 8% has resistance to isoniazid (H) only, 2% has resistant to Rifampicin (R) only and 11% has resistant both to H and R (MDR-TB). Countries has started using Xpert MTB/Rif and R resistant cases are being put on MDR-Tb treatment. Among cases with at least R resistant status (both by phenotypic and genotypic) 33% are R resistant, among which 10% are from the new cases and 55% are from retreatment cases. 

<a id="t-drnotif"></a> 

##### `r I(pasteLabel("Table", tableCount, "t-drnotif", insLink=FALSE))`. Drug resistance in select countries, `r yr`


```{r t-drnotif, results='asis'}

# Make that table
htmlTable(nbf, caption = "", rowlabel = "", cgroup = c("Cases with DST results", "% with DST results", "% with resistance to H only", "% with resistance to R only", "% MDR-TB<sup>*</sup>", "Additional cases confirmed by Xpert", "% Xpert cases MDR-TB<sup>*</sup>"), n.cgroup = c(3,3,3,3,3,3,3), ctable = TRUE, tfoot = "<sup>*</sup> Resistant to H and R. Totals also include History Unknown.")
```


```{r f-align-bar-data}

figCount <- incCount(figCount, "f-align-bar")

tea <- subset(tb, year %in% 2007:yr & g_whoregion=="WPR", select=c(iso3, country, year, e_mdr_num, e_mdr_num_lo, e_mdr_num_hi, mdr, rapid_dx_dr_r, conf_mdr_tx, unconf_mdr_tx))

teb1 <- aggregate(tea[4:ncol(tea)], by=list(year=tea$year), FUN=sum, na.rm=TRUE)
teb1$country <- teb1$iso3 <- "WPR"

# Separate hbcs
teb3 <- tea[tea$iso3 %in% whbc,] 
# teb2 <- aggregate(teb3[4:ncol(tea)], by=list(year=teb3$year, area=teb3$country), FUN=sum, na.rm=TRUE)


#combine
teb <- rbind(teb1, teb3)

# Calculate new vars
teb$`Cases confirmed` <- .rowsums(teb[c('mdr', 'rapid_dx_dr_r')])
teb$`Patients enrolled on treatment` <- .rowsums(teb[c('conf_mdr_tx', 'unconf_mdr_tx')])


tec <- melt(teb[c("country", "year", "Cases confirmed", "Patients enrolled on treatment")], id=1:2)

ted <- ggplot(tec, aes(year, value, color=variable)) + geom_point(alpha=.5) + geom_line(size=1, alpha=.5) + facet_wrap(~country, scales="free_y", ncol=4) + theme_report() + scale_color_brewer("", type="qual", palette=6) + scale_x_continuous("") + scale_y_continuous("MDR-TB cases")  + guides(fill = guide_legend(reverse = TRUE)) + theme(legend.position = "bottom")

write.csv(tec, file=paste0(pasteLabel("./figure_data/figure", figCount, "f-align-bar", insLink=FALSE), ".csv"), row.names=FALSE)
```

#### Notification and enrolment
			Year, number notified and enrolled, % of total burden
			Age, sex?
The 10578 reported cases of Rif resistant (considered as MDR-TB) cases represented 15% (11-23%) of the 71 000 (range 47000 – 94000) pulmonary TB patients estimated to have MDR-TB  in 2013 in this Region. X% of cases  are identified by phenotypic (both H and R resistance) and X% of cases are identified by genotypic (Rif resistance only).

Among reported cases X% are from new and X% are from retreatment cases. The reported MDR-TB (R resistant) among retreatment cases represented x% of the 18000 (range 14000 – 21000) estimated MDR-TB among retreatment cases. (COUNTRIES THAT ARE DOING >60% OF THE ESTIMATE) The reported MDR-TB (R resistant) among new cases represented x% of the 57000 (range 40000 – 74000) estimated MDR-TB among new.

X% of the cases are between age group of  X- X. Among notified cases X number is below 15 years of age. Male female ratio of reported cases is X: X.

The absolute numbers of TB cases started on second-line treatment for MDR-TB was 6921 which is 65% of the notified cases. There was steady increase in case enrolment over the years which are prominent from 2011 to 2014. However the ratio of the numbers of patients starting treatment for MDR-Tb, to those notified was also increased. GIVE SPECIFIC COUNTRY SITUATION AND REFER TO THE GRAPH.

<a id="f-align"></a> 

##### `r I(pasteLabel("Figure", figCount, "f-align-bar", insLink=FALSE))`. Trend of notification and enrolment of MDR-TB cases in the Western Pacific Region, 2006`r paste0("\u2013", yr-2)`
Graph showing notification and enrolment
``` {r f-align-bar, fig.width=9, fig.height=9}
ted
```


#### Treatment outcome


```{r f-mtxout-bar-data}

figCount <- incCount(figCount, "f-mtxout-bar")

tra <- subset(tb, year %in% 2006:(yr-2) & g_whoregion=="WPR", select=c(iso3, country, year, mdr_coh, mdr_cur, mdr_cmplt, mdr_died, mdr_fail, mdr_def, mdr_succ))

# Fill in 0s for NAs
tra[is.na(tra)] <- 0

trb1 <- aggregate(tra[4:ncol(tra)], by=list(year=tra$year), FUN=sum, na.rm=TRUE)
trb1$area <- trb1$iso3 <- "WPR"

# Separate hbcs
trb2 <- subset(tra, iso3 %in% whbc & mdr_coh > 0) 
trb2 <- rename(trb2, c(country="area"))
# trb2 <- aggregate(tra[4:ncol(tra)], by=list(year=tra$year, area=tra$country), FUN=sum, na.rm=TRUE)

#combine
trb <- rbind(trb1, trb2)

trb$mdr_succ <- ifelse(trb$year>=2011, trb$mdr_succ, trb$mdr_cur + trb$mdr_cmplt)
trb$Success <- trb$mdr_succ / trb$mdr_coh * 100
trb$Died <- trb$mdr_died / trb$mdr_coh * 100
trb$Failed <- trb$mdr_fail / trb$mdr_coh * 100
trb$Defaulted <- trb$mdr_def / trb$mdr_coh * 100
trb$`Not evaluated` <- (trb$mdr_coh - (trb$mdr_succ + trb$mdr_died + trb$mdr_fail + trb$mdr_def)) / trb$mdr_coh * 100

trc <- melt(trb[c("area", "year", "Success", "Died", "Failed", "Defaulted", "Not evaluated")], id=1:2)

write.csv(trc, file=paste0(pasteLabel("./figure_data/figure", figCount, "f-mtxout-bar", insLink=FALSE), ".csv"), row.names=FALSE)

```



X countries reported their treatment outcome of 2011 cohort. In the 2011 cohort, the proportion of   MDR-Tb patients who successfully completed treatment was X%, X% was of cases were reported as loss to follow up and X% died. Treatment success was highest in …….and lowest in ……… 

DO WE KNOW OUTCOME OF XDR_TB COHORT IN ANY COUNTRY?

<a id="f-mtxout-bar"></a> 

##### `r I(pasteLabel("Figure", figCount, "f-mtxout-bar", insLink=FALSE))`.  Trend of treatment outcome expressed as a proportion among MDR-TB cases in the Western Pacific Region, 2006--`r yr-2`
``` {r f-mtxout-bar, fig.width=9, fig.height=7}

ggplot(trc[trc$area=="WPR",], aes(year, value, fill=variable)) + geom_bar(stat="identity", position="stack") + theme_report() + scale_fill_brewer('Outcome', type="qual", palette=6) + scale_x_continuous("", breaks=min(trc$year):max(trc$year)) + scale_y_continuous("Percent of cohort") + coord_cartesian(ylim=c(0,100)) + guides(fill = guide_legend(reverse = TRUE))

ggplot(trc, aes(year, value, fill=variable)) + geom_bar(stat="identity", position="stack") + facet_wrap(~area) + theme_report() + scale_fill_brewer('Outcome', type="qual", palette=6) + scale_x_continuous("") + scale_y_continuous("Percent of cohort") + coord_cartesian(ylim=c(0,100)) + guides(fill = guide_legend(reverse = TRUE))


```

			

### XDR-TB

```{r t-xdr-data, warning=FALSE}
tableCount <- incCount(tableCount, "t-xdr")

# Notification table

xa <- subset(tb, year==yr & g_whoregion=="WPR", 
              select=c(iso3, g_whoregion, country, 
                       mdr, mdr_dst_rlt, mdr_ds_fq2li,
                       mdr_dr_fq, mdr_dr_2li, xdr))

xa <- xa[order(xa$country),]
names(xa)[names(xa)=='country'] <- 'area'

# make aggregate rows
xb <- xa[xa$iso3 %in% whbc, ]
xc <- aggregate(xb[4:ncol(xb)], by=list(area=xb$g_whoregion), FUN=sum, na.rm=TRUE)
xc$area <- "Total"

xd <- aggregate(xa[4:ncol(xa)], by=list(area=xa$g_whoregion), FUN=sum, na.rm=TRUE)

# combine together
xe <- rbind(xb[3:ncol(xb)], xc, xd) # , tbbh, tbbga

# calculate and format vars
xe$xdst_pct <- xe$mdr_dst_rlt / xe$mdr * 100
xe$fq_pct <- xe$mdr_dr_fq / xe$mdr * 100
xe$xli_pct <- xe$mdr_dr_2li / xe$mdr * 100
xe$xdr_pct <- xe$xdr / xe$mdr * 100

# Format
for(var in 2:ncol(xe)){
  xe[var] <- ifelse(is.na(xe[[var]]), "&#8211;", rounder(xe[[var]]))
}


# Rename countries
xf <- .WPSARnames(xe, col="area")

rownames(xf) <- xf$area

xg <- subset(xf, select=c("mdr", "xdst_pct", "mdr_dr_fq", "fq_pct", "mdr_dr_2li", "xli_pct", "xdr", "xdr_pct"))

names(xg) <- c("MDR-TB", "% 2<sup>nd</sup>-line DST", rep(c("Number", "%"),3))

write.csv(xf, file=paste0(pasteLabel("./figure_data/table", tableCount, "t-drnotif", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```

XDR-TB had been reported by 6 countries in the Region (17% of all countries and areas in the Region) in 2013. Total reported XDR-TB cases are 106 (2% of MDR-TB cases). The highest rate is shown in Republic of Korea which is 9% of all MDR-TB cases. Data on resistance to FQ and injectable agents among cases with MDR-TB were reported from 12 countries. Combining data from all countries, the proportion of MDR-TB cases with resistance to FQ is 4% and with resistance to second line injectable agents is 3%.  2% of MDR-TB cases are XDR-TB. A total of 7% of patients with MDR-TB had resistance to either a FQ or a second line injectable agent or both.

<a id="t-xdr"></a> 

##### `r I(pasteLabel("Table", tableCount, "t-xdr", insLink=FALSE))`.			Rate (FQ and injectable)
```{r t-xdr, results='asis'}

# Make that table
htmlTable(xg, caption = "", rowlabel = "", cgroup = c("", "Resistance to FQ", "Resistance to 2<sup>nd</sup>-line injectible", "XDR-TB"), n.cgroup = c(2,2,2,2), ctable = TRUE, tfoot = "")
```



### Funding situation; drug cost

X million USD was spent for MDR-TB management which was X% of the total budget of NTP in 2013. Among the total spent X% is from domestic source (Government allocation), X% from loan and X% from grant. Second line drugs are X% of the total cost for MDR-TB management. Expenditure for SLD has been significantly increased over years.

### WPRO response
In 2011 the Western Pacific Region Green Light Committee (WPR rGLC) was established to assist member countries with responsible scale-up of programmatic management of drug resistant TB. The rGLC initiative shifted the focus from “regulation and control” to “support and assistance”.  The WPR rGLC is composed of a secretariat based at the regional WHO office in Manila, and an expert committee with complimentary skill sets. Key activities included PMDT evaluation, critical review of mission reports, contributions to regional capacity building and strategic and technical guidance.  The expert committee had regular teleconferences and bi-annual face-to-face meetings.  The Secretariat coordinated monitoring missions and arranged critical review of all country reports within strict timelines.  Priority recommendations were clearly communicated and progress reviewed during subsequent visits. Regional training of trainers, consultant courses on PMDT and drug management were organized, as well as in-country training on clinical aspects of MDR-TB management. A rotating stockpile of second-line drugs for Pacific Island Countries and Areas was maintained.  Recognizing the important role of the private sector within the region, rGLC assisted selected countries to assess the scope of private sector involvement in PMDT.  rGLC also worked with countries regarding the introduction and protection of novel TB drugs.  	

	Table: mission and TA listed 



Discussion
---------------------------------------------------

```{r t-drestnotif-data, warning=FALSE}
tableCount <- incCount(tableCount, "t-drestnotif")

# Notification table

oa <- subset(tb, year==yr & g_whoregion=="WPR", 
              select=c(iso3, g_whoregion, country, 
                       e_new_mdr_prop, e_new_mdr_prop_lo, e_new_mdr_prop_hi,
                       e_ret_mdr_prop, e_ret_mdr_prop_lo, e_ret_mdr_prop_hi,
                       e_mdr_num, e_mdr_num_lo, e_mdr_num_hi,
                       c_newunk, c_ret, 
                       dst_rlt_new, dst_rlt_ret, dst_rlt_unk, 
                       mdr_new,  mdr_ret,  mdr, rapid_dx_dr_r, 
                       conf_mdr_tx, unconf_mdr_tx))

oa <- oa[order(oa$country),]
names(oa)[names(oa)=='country'] <- 'area'
estvars <- c("e_new_mdr_prop", "e_new_mdr_prop_lo", "e_new_mdr_prop_hi", "e_ret_mdr_prop", "e_ret_mdr_prop_lo", "e_ret_mdr_prop_hi", "e_mdr_num", "e_mdr_num_lo", "e_mdr_num_hi")

# make aggregate rows
ob <- oa[oa$iso3 %in% whbc, ]
obh <- aggregate(ob[4:ncol(ob)], by=list(area=ob$g_whoregion), FUN=sum, na.rm=TRUE)
obh$area <- "Total"
obh[estvars] <- NA # Not the proper way to sum bounds. Maybe to replace this later.

obw <- aggregate(oa[4:ncol(oa)], by=list(area=oa$g_whoregion), FUN=sum, na.rm=TRUE)
obw[estvars] <- subset(emdra, year==yr & group_name=="WPR", estvars) # Proper sums for aggregates.

# combine together
oc <- rbind(ob[3:ncol(ob)], obh, obw) 

# calculate and format vars

for(stima in c("new", "ret")){ # change proportional estimates to percent
  for(bound in c("", "_lo", "_hi")){
    oc[paste0("e_", stima, "_mdr_pct", bound)] <- oc[paste0("e_", stima, "_mdr_prop", bound)] * 100
  }
}

oc$e_new_mdr_pct_range <- paste0("(", rounder(oc$e_new_mdr_pct_lo), "&#8211;", rounder(oc$e_new_mdr_pct_hi), ")")
oc$e_ret_mdr_pct_range <- paste0("(", rounder(oc$e_ret_mdr_pct_lo), "&#8211;", rounder(oc$e_ret_mdr_pct_hi), ")")
oc$e_mdr_num_range <- paste0("(", rounder(oc$e_mdr_num_lo), "&#8211;", rounder(oc$e_mdr_num_hi), ")")

oc$dst_rlt_new_pct <- rounder(oc$dst_rlt_new / oc$c_newunk * 100)
oc$dst_rlt_ret_pct <- rounder(oc$dst_rlt_ret / oc$c_ret * 100)

oc$mdr_new_pct <- rounder(oc$mdr_new / oc$c_newunk * 100)
oc$mdr_ret_pct <- rounder(oc$mdr_ret / oc$c_ret * 100)

oc$mdr_tx <- .rowsums(oc[c('conf_mdr_tx', 'unconf_mdr_tx')])

# Format
for(var in c("e_new_mdr_pct", "e_ret_mdr_pct", "e_mdr_num", "mdr", "rapid_dx_dr_r", "conf_mdr_tx", "mdr_tx")){
  oc[var] <- ifelse(is.na(oc[[var]]), "&#8211;", rounder(oc[[var]]))
}
for(var in c("mdr_new_pct", "mdr_ret_pct")){
  oc[var] <- ifelse(is.na(oc[[var]]), "&#8211;", oc[[var]])
}

# Rename countries
od <- .WPSARnames(oc, col="area")

rownames(od) <- od$area

oe <- subset(od, select=c("mdr_new_pct", "e_new_mdr_pct", "e_new_mdr_pct_range", "mdr_ret_pct", "e_ret_mdr_pct", "e_ret_mdr_pct_range", "mdr", "e_mdr_num", "e_mdr_num_range", "rapid_dx_dr_r", "conf_mdr_tx", "mdr_tx"))


write.csv(oe, file=paste0(pasteLabel("./figure_data/table", tableCount, "t-drestnotif", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```

<a id="t-drestnotif"></a> 

##### `r I(pasteLabel("Table", tableCount, "t-drestnotif", insLink=FALSE))`. Estimated drug resistant cases compared with notified cases and cases put on treatment, `r yr`
```{r t-drestnotif, results='asis'}
             
# Make that table
htmlTable(oe, caption = "", rowlabel = "", cgroup = rbind(c("% MDR-TB among new", "% MDR-TB among ret.", "MDR-TB cases", "", rep(NA,5)), c(rep(c("Detected", "Estimated"),2), "Detected", "Estimated <br>___________________", "RR cases<sup>*</sup>", "Confirmed MDR-TB on treatment", "Total MDR-TB on treatment")), n.cgroup = rbind(c(3,3,3,3, rep(NA,5)), c(1,2,1,2,1,2,1,1,1)), align=c(rep(c('c','r', 'l'),3), rep("c",3) ), ctable = TRUE, tfoot = "<sup>*</sup> Additional Rifampicine resistant cases detected by Xpert.", headings = NA )

```

The region included countries with high MDR-TB caseloads such as China, Viet Nam and the Philippines and Pacific Island nations with very small, irregular caseloads. Member States of the Western Pacific Region are also at different stages of PMDT implementation
National representative drug resistance survey data is available from 5 out of 7 high TB burden countries of the Region (Cambodia, China, Mongolia, Philippines and Viet Nam). Among them Cambodia, Philippines and Viet Nam has two survey data point and China is conducting it's 2nd DRS.  Two remaining countries without representative data are PNG and Lao PDR. Subnational DRS in PNG is ongoing and results are expected to be available in 2015. 

Several countries such as Viet Nam and the Philippines showed commendable progress. These countries are quickly moving to nationwide expansion. The PMDT program in China has continued to evolve.

Though there is a sign of increasing trend in notification and enrolment of MDR-TB cases, so far the scale-up of the programmatic management of MDR-TB (PMDT) is slow with only 6% of the estimated MDR-TB among notified cases being reported under PMDT. In addition, cure rates are low, below 50%. None of the countries are on track to meet the global targets of universal access as called for by the Resolution WHA62.15 in 2009. New tools, both diagnostics and drugs, have the potential to boost and facilitate the MDR-TB response, provided that bold investments will be made to introduce these while at the same time preventing catastrophic expenditures at both patient and health services level.


```{r exploration, warning=FALSE, include=FALSE}
tableCount <- incCount(tableCount, "t-drestnotif")

# Explore the association between MDR adn other things

oa <- subset(tb, year==yr & g_whoregion=="WPR", 
              select=c(iso3, g_whoregion, country, 
                       mdr_hivpos, mdr_hivneg, mdr_hivunk, 
                       nmdr_hivpos, nmdr_hivneg, nmdr_hivunk, 
                       mdr_f, mdr_m, mdr_sexunk, 
                       nmdr_f, nmdr_m, nmdr_sexunk, 
                       mdr_014, mdr_15plus, mdr_ageunk, 
                       nmdr_014, nmdr_15plus, nmdr_ageunk))

oa <- oa[order(oa$country),]
names(oa)[names(oa)=='country'] <- 'area'


# make aggregate rows
ob <- oa[oa$iso3 %in% whbc, ]
obh <- aggregate(ob[4:ncol(ob)], by=list(area=ob$g_whoregion), FUN=sum, na.rm=TRUE)
obh$area <- "Total"


obw <- aggregate(oa[4:ncol(oa)], by=list(area=oa$g_whoregion), FUN=sum, na.rm=TRUE)


# combine together
oc <- rbind(ob[3:ncol(ob)], obh, obw) 

# calculate and format vars

vars <- data.frame(left=c("hivpos", "f", "014"), middle=c("hivneg", "m", "15plus"), right=c("hiv", "sex", "age"))

for(type in 1:3){
  oc[paste0(vars[type,3], "_rr")] <- (oc[paste0("mdr_", vars[type,1])] /
                                            .rowsums(oc[c(paste0("mdr_", vars[type,1]), paste0("mdr_", vars[type,2]), paste0("mdr_", vars[type,3], "unk"))])) / 
                                             (oc[paste0("nmdr_", vars[type,1])] /
                                            .rowsums(oc[c(paste0("nmdr_", vars[type,1]), paste0("nmdr_", vars[type,2]), paste0("nmdr_", vars[type,3], "unk"))]))
}


# Format
for(var in c("hiv_rr", "sex_rr", "age_rr")){
  oc[var] <- ifelse(is.na(oc[[var]]), "&#8211;", signif(oc[[var]], 3))
}


# Rename countries
od <- .WPSARnames(oc, col="area")

rownames(od) <- od$area

oe <- subset(od, select=c("hiv_rr", "sex_rr", "age_rr"))

# Make that table
htmlTable(oe, caption = "Risk ratios for MDR-TB")
# , rowlabel = "", cgroup = rbind(c("% MDR-TB among new", "% MDR-TB among ret.", "MDR-TB cases", "", rep(NA,5)), c(rep(c("Detected", "Estimated"),2), "Detected", "Estimated <br>___________________", "RR cases<sup>*</sup>", "Confirmed MDR-TB on treatment", "Total MDR-TB on treatment")), n.cgroup = rbind(c(3,3,3,3, rep(NA,5)), c(1,2,1,2,1,2,1,1,1)), align=c(rep(c('c','r', 'l'),3), rep("c",3) ), ctable = TRUE, tfoot = "<sup>*</sup> Additional Rifampicine resistant cases detected by Xpert.", headings = NA )


write.csv(oe, file=paste0(pasteLabel("./figure_data/table", tableCount, "t-drestnotif", insLink=FALSE, sepper=""), ".csv"), row.names=FALSE, na="")

```


### Conflicts of interest
None declared.

### Funding
None.

References
--------------------------------------------------------





